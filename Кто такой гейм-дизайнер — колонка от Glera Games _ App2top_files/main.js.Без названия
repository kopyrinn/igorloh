var BANNER_VIDEO_REGEX_STRING=new RegExp("^video"),BANNER_YANDEX_CLIENT_ID_TEMPLATE="{{client_id}}",BANNER_DISPLAY_ROOT_MARGIN="-64px 0px 0px 0px",BANNER_DISPLAY_INTERSECTION=.7,BannerEvents={Load:"load",Click:"click",SendYandexGoal:"send-yandex-goal"};function Banner(e,t){this.container=e,this.id=t.id||"",this.rawLink=t.raw_link||"",this.views=t.views||[],this.class=t.class||"",this.title=t.title||"",this.currentViewItem=null,this.currentItem=null,this.containerShowClass=t.container_show_class||"",this.containerHideClass=t.container_hide_class||"",this.compareFunction=t.cover_mode?this._compareCoverView:this._compareContainView,this.fixedMaxWidth=t.fixed_max_width||!1,this.yandexMetrikaId=t.yandex_metrika_id||0,this.disableYandexMetrika=t.disable_yandex_metrika||!1,this.isLoaded=!1,this.isDisplayed=!1,this.eventsListeners=[],this.immediateEventsListeners={},this._initIntersectionObserver()}Banner.prototype.update=function(e){var t,n;this.container&&(e=(n=(t=this.container.clientWidth)?this._findItem(t,e):n)?n.item:null,this.currentViewItem!==e&&(this._clearContainer(),this.currentViewItem=e,(n=this._createItem(n,this.class,this.title))?(this.container.appendChild(n),this.containerHideClass&&this.container.classList.remove(this.containerHideClass),this.containerShowClass&&this.container.classList.add(this.containerShowClass),this.isLoaded&&!this.isDisplayed&&this.intersectionObserver.observe(n)):(this.containerShowClass&&this.container.classList.remove(this.containerShowClass),this.containerHideClass&&this.container.classList.add(this.containerHideClass)),this.currentItem=n))},Banner.prototype.addEventListener=function(e,t){if("function"!=typeof t)return{remove:function(){}};this.eventsListeners.push({event:e,callback:t});var n=this.immediateEventsListeners[e];return n&&t.apply(null,n.params),{remove:this.removeEventListener.bind(this,e,t)}},Banner.prototype.removeEventListener=function(t,n){this.eventsListeners=this.eventsListeners.filter(function(e){return!(e.event===t&&e.callback===n)})},Banner.prototype._callEventListeners=function(){for(var t=arguments[0],n=[this],e=1;e<arguments.length;e++)n.push(arguments[e]);var i=!1;return this.eventsListeners.forEach(function(e){e.event===t&&!1===e.callback.apply(e,n)&&(i=!0)}),!i},Banner.prototype._setImmediateEventListener=function(){for(var e=arguments[0],t=[this],n=1;n<arguments.length;n++)t.push(arguments[n]);this.immediateEventsListeners[e]={params:t}},Banner.prototype._initIntersectionObserver=function(){window.IntersectionObserver?this.intersectionObserver=new IntersectionObserver(this._checkDisplay.bind(this),{rootMargin:BANNER_DISPLAY_ROOT_MARGIN,threshold:BANNER_DISPLAY_INTERSECTION}):this.intersectionObserver={observe:function(){},unobserve:function(){},takeRecords:function(){return[]}}},Banner.prototype._checkDisplay=function(e){this.isLoaded&&!this.isDisplayed&&this.currentItem&&e.forEach(function(e){var t,n;e.isIntersecting&&e.intersectionRatio>=BANNER_DISPLAY_INTERSECTION&&(this.isDisplayed=!0,t=this.currentViewItem&&this.currentViewItem.src,n=this.currentViewItem&&this.currentViewItem.size_name,e=this.currentViewItem&&this.currentViewItem.ratio,this._sendYandexGoal("hit",{banner_hit:{banner_hit_id:this.id||"no ID",banner_hit_link:this.rawLink||"no link",banner_hit_look:t&&t.url||"no look",banner_hit_type:t&&t.type||"no type",banner_hit_size:n||"no size",banner_hit_ratio:e||"no ratio"}}),this._stopObserveIntersection(this.currentItem))}.bind(this))},Banner.prototype._findItem=function(n,e){var i,t;if(t=(t=this.views.reduce(function(e,t){return i&&!this.compareFunction(t.width,i.width)||(i=t),this.compareFunction(t.width,n)&&(!e||this.compareFunction(e.width,t.width))?t:e}.bind(this),null))||i)for(var o in t.items){o=t.items[o];if(!o.ratio||o.ratio===e)return{view:t,item:o}}return null},Banner.prototype._compareContainView=function(e,t){return e<=t},Banner.prototype._compareCoverView=function(e,t){return t<=e},Banner.prototype._clearContainer=function(){this.container.innerHTML="",this._stopObserveIntersection(this.currentItem)},Banner.prototype._stopObserveIntersection=function(){this.currentItem&&this.intersectionObserver.unobserve(this.currentItem)},Banner.prototype._createItem=function(e,t,n){if(e&&e.item&&e.item.src){var i=e.item.src,o=e.item.size_name,r=e.item.ratio,s=e.view.width,a=document.createElement("div"),c=document.createElement(i.link?"a":"div"),e=this._isVideo(i.type)?this._createVideo(i.url):this._createImage(i.url);return c.appendChild(e),a.appendChild(c),a.className=t,this.fixedMaxWidth&&(a.style.maxWidth=s+"px"),c.className="information-block-inner",c.title=n||"",i.link&&(c.href=i.link,c.target="_blank",c.rel="nofollow noopener",this._setClientId(c)),c.addEventListener("click",this._onClick.bind(this,i,o,r)),a}},Banner.prototype._isVideo=function(e){return BANNER_VIDEO_REGEX_STRING.test(e)},Banner.prototype._createImage=function(e){if(e){var t=document.createElement("img");return t.src=e,t.onload=this._onLoad.bind(this,e),t}},Banner.prototype._createVideo=function(e){if(e){var t=document.createElement("video");return t.src=e,t.addEventListener("canplay",this._onLoad.bind(this,e)),t.autoplay=!0,t.loop=!0,t.muted=!0,t.playsinline=!0,t.setAttribute("autoplay",""),t.setAttribute("playsinline",""),t.setAttribute("muted",""),t.setAttribute("loop",""),t}},Banner.prototype._onClick=function(e,t,n){this._callEventListeners(BannerEvents.Click,e,t,n)&&this._sendYandexGoal("click",{banner_click:{banner_click_id:this.id||"no ID",banner_click_link:this.rawLink||"no link",banner_click_look:e.url||"no look",banner_click_type:e.type||"no type",banner_click_size:t||"no size",banner_click_ratio:n||"no ratio"}})},Banner.prototype._onLoad=function(){this.isLoaded||(this.isLoaded=!0,this.currentItem&&this.intersectionObserver.observe(this.currentItem),this._setImmediateEventListener(BannerEvents.Load),this._callEventListeners(BannerEvents.Load))},Banner.prototype._sendYandexGoal=function(t,n){setTimeout(function(){var e;this.id&&this.yandexMetrikaId&&window.ym&&!this.disableYandexMetrika&&(e=this.id+"-"+t,this._callEventListeners(BannerEvents.SendYandexGoal,e,n)?(console.log("reachGoal",this.id+"-"+t,n),setTimeout(function(){ym(this.yandexMetrikaId,"reachGoal",e,n)}.bind(this),0)):console.log("PREVENT"))}.bind(this),0)},Banner.prototype._setClientId=function(t){this.yandexMetrikaId&&window.ym&&!this.disableYandexMetrika&&ym(this.yandexMetrikaId,"getClientID",function(e){t.href=t.href.replace(BANNER_YANDEX_CLIENT_ID_TEMPLATE,e)})};var Banners=function(){var r="a2t_banners_inited",i={1:"default_ratio",1.1:"HiDPI_ratio"},s=[],o=[];function t(){for(var e=document.getElementsByClassName("information-block"),t=0;t<e.length;t++){var n=e[t];if(!n[r]){n[r]=!0;var i=n.getAttribute("data-information");if(i)try{var o=new Banner(n,JSON.parse(i));s.push(o),c(o)}catch(e){console.error(e)}}}a()}function a(){var e,t="",n=Math.max(window.devicePixelRatio||1,1);for(e in i)e<=n&&(t=i[e]);s.forEach(function(e){e.update(t)})}function c(t,e){(e=e||o.filter(function(e){return e.bannerId===t.id})).forEach(function(e){t.addEventListener(e.event,e.callback)})}return document.addEventListener("DOMContentLoaded",function(e){t(),window.addEventListener("resize",a)}),{reload:t,addBannerEventListener:function(t,e,n){if(!t||!e||"function"!=typeof n)return{remove:function(){}};var i={bannerId:t,event:e,callback:n};return o.push(i),s.forEach(function(e){e.id===t&&c(e,[i])}),{remove:function(){var t;t=i,s.forEach(function(e){e.id===t.bannerId&&e.removeEventListener(t.event,t.callback)}),o=o.filter(function(e){return e!==t})}}}}}();function IntervalQueues(e,t){this.timeout=e||0,this.completeCallback=t,this.queues={},this.runningTimers={}}IntervalQueues.prototype.add=function(e,t){(this.queues[e]=this.queues[e]||[]).push(t),this._run(e)},IntervalQueues.prototype._run=function(e){this.runningTimers[e]||this._do(e)},IntervalQueues.prototype._do=function(e){var t;this.queues[e]&&0<this.queues[e].length?((t=this.queues[e].shift())&&t(),this.runningTimers[e]=setTimeout(this._do.bind(this,e),this.timeout)):(this.clear(e),this.stop(e),this.completeCallback&&this.completeCallback(e))},IntervalQueues.prototype.isRun=function(e){return!!this.runningTimers[e]},IntervalQueues.prototype.clear=function(e){var t=0;return this.queues[e]&&(t=this.queues[e].length,delete this.queues[e]),t},IntervalQueues.prototype.stop=function(e){return this.runningTimers[e]?(clearTimeout(this.runningTimers[e]),delete this.runningTimers[e],!0):this.queues[e]},function(){var t,n,c,l,i="cnt-ad-banners-background_top_desktop",o="cnt-ad-banners-background_top_mobile",r="cnt-ad-banners-background_back",d="cnt-ad-banners-background-content-hit",s="cnt-ad-banners-background-click",u=!1;function a(e){const a=t||n;!u&&a&&e.forEach(function(e){var t,n,i,o,r,s;e.isIntersecting&&e.intersectionRatio>=BANNER_DISPLAY_INTERSECTION&&(u=!0,console.log("content area HIT"),t=a&&a.currentViewItem&&a.currentViewItem.src,n=a&&a.currentViewItem&&a.currentViewItem.size_name,i=a&&a.currentViewItem&&a.currentViewItem.ratio,o=c&&c.currentViewItem&&c.currentViewItem.src,r=c&&c.currentViewItem&&c.currentViewItem.size_name,s=c&&c.currentViewItem&&c.currentViewItem.ratio,e=a||o,_(a.yandexMetrikaId,d,{banner_background_content_hit:{banner_background_content_hit_link:e&&e.rawLink||"no link",banner_background_content_hit_top_banner_id:a&&a.id||"no ID",banner_background_content_hit_top_banner_look:t&&t.url||"no look",banner_background_content_hit_top_banner_type:t&&t.type||"no type",banner_background_content_hit_top_banner_size:n||"no size",banner_background_content_hit_top_banner_ratio:i||"no ratio",banner_background_content_hit_back_banner_id:c&&c.id||"no ID",banner_background_content_hit_back_banner_look:o&&o.url||"no look",banner_background_content_hit_back_banner_type:o&&o.type||"no type",banner_background_content_hit_back_banner_size:r||"no size",banner_background_content_hit_back_banner_ratio:s||"no ratio"}}),l&&l.disconnect())}.bind(this))}function h(e,t,n,i){console.log("banner click",e),_(e.yandexMetrikaId,s,{banner_click:{banner_click_id:e.id||"no ID",banner_click_link:e.rawLink||"no link",banner_click_look:t.url||"no look",banner_click_type:t.type||"no type",banner_click_size:n||"no size",banner_click_ratio:i||"no ratio"}})}function _(e,t,n){e&&window.ym&&(console.log("sendYandexGoal bg",t,n),setTimeout(function(){ym(e,"reachGoal",t,n)}.bind(this),0))}setTimeout(function(){window.Banners&&(Banners.addBannerEventListener(i,BannerEvents.Load,function(e){t=e}),Banners.addBannerEventListener(o,BannerEvents.Load,function(e){n=e}),Banners.addBannerEventListener(r,BannerEvents.Load,function(e){c=e}),function(){var e=document.getElementsByClassName("information-block-top-hit-area");if(window.IntersectionObserver){l=new IntersectionObserver(a,{rootMargin:BANNER_DISPLAY_ROOT_MARGIN,threshold:BANNER_DISPLAY_INTERSECTION});for(var t=0;t<e.length;t++)l.observe(e[t])}}(),function(){function e(){return!1}Banners.addBannerEventListener(i,BannerEvents.SendYandexGoal,e),Banners.addBannerEventListener(o,BannerEvents.SendYandexGoal,e),Banners.addBannerEventListener(r,BannerEvents.SendYandexGoal,e),Banners.addBannerEventListener(i,BannerEvents.Click,h),Banners.addBannerEventListener(o,BannerEvents.Click,h),Banners.addBannerEventListener(r,BannerEvents.Click,h)}())},0)}();var COMMENTS_BLOCK_ID_PREFIX="comments-block-",SHOW_COMMENTS_CLASS="show-comments";function openComments(e){$("#"+COMMENTS_BLOCK_ID_PREFIX+e).addClass(SHOW_COMMENTS_CLASS)}function closeComments(e){$("#"+COMMENTS_BLOCK_ID_PREFIX+e).removeClass(SHOW_COMMENTS_CLASS)}!function(){var e=location.hash.match(/^#comments-(\d+)$/i);e&&e[1]&&openComments(e[1])}(),jQuery(document).ready(function(e){var t=e(window),n=e(document.body);function i(){n[0<t.scrollTop()?"addClass":"removeClass"]("page-scrolled")}i(),t.scroll(i)}),function(){var t,o,u,r,s,a,i,c,l,n,d,h,_,f,p,m,v,b,E,I,k,y,w;function g(){this.isAllCompleted=!1,this.completedGoals={}}function L(e,t,n){this.goalName=e,this.postData=t,this.$element=n,g.call(this)}function C(e,t,n,i){this.$element=t,this.$contentElement=t.find(".post-content"),this.id=Number(e),this.url=n||"",this.title=i?i+o:"",this.yandexMetrikaGoalsProgress={},this.yandexMetrikaGoalsProgress[c.POST_BLOCK_HIT_PROGRESS]=new g,this.yandexMetrikaGoalsProgress[c.POST_CONTENT_HIT_PROGRESS]=new g,this.index=_.push(this)-1,I.push(new L(c.POST_BLOCK_DISPLAY_PROGRESS,this,this.$element)),I.push(new L(c.POST_CONTENT_DISPLAY_PROGRESS,this,this.$contentElement))}function B(e){(b=e)?d.show():d.hide()}function e(){var e;b||s||!n[0]||(e=document.documentElement.clientHeight/2,n[0].getBoundingClientRect().top-e<document.documentElement.clientHeight&&(b||s||(B(!0),e={tags:infinityPostsData.tags,root_post_id:f.id,offset:r+1},a.excludePostsIds&&0<a.excludePostsIds.length&&(e.exclude_other_posts_ids=a.excludePostsIds),a.beforeDate&&(e.other_posts_before_date=a.beforeDate),$.ajax({url:t,data:e,dataType:"json"}).done(function(e,t,n){var i;r=e.offset,s=!!e.is_last,e.post&&(i=new C(e.post.id,$(e.post.view),e.post.url,e.post.title),l.append(i.$element)),e.other_posts&&(a.excludePostsIds=e.other_posts.exclude_posts_ids,a.beforeDate=e.other_posts.before_date),window.Banners&&Banners.reload(),setTimeout(P,0)}).fail(function(){s=!0}).always(function(){B(!1)}))))}function S(){var e,t=document.documentElement.clientHeight,n=t/2,i=w,o=p,r=h.height();if(m<window.pageYOffset||v<t)for(;o<_.length;o++){var s=_[o].$element[0].getBoundingClientRect().top;if(!(s<n))break;if(i=o,r<=s)break}else for(;0<=o;o--){var a=_[o].$element[0].getBoundingClientRect();if(a.top<n){if(!(a.top>=r)){i===w&&(i=o);break}i=o}}if(i!==w){if(m=window.pageYOffset,v=t,p!==i)return p!==(e=i)&&(t=_[p=e],e=location.pathname+location.search,t.url!==e&&(document.title=t.title,t&&history&&history.replaceState(null,t.title,t.url),u&&u.id&&window.ym&&ym(u.id,"hit",t.url,{referer:e,title:t.title}))),1}else console.error("New current post not found")}function T(e,t,n,i,o){var r;u&&u.id&&window.ym&&(r=e+(null!=t?"_"+t:""),t=function(){ym(u.id,"reachGoal",r,n)},o?y.add(r,t):t())}function O(e,t,n){var i=n.yandexMetrikaGoalsProgress[e];if(!i.isAllCompleted){var o=u.goals[e];if(o&&o.length){for(var r=document.documentElement.clientHeight,s=t[0].getBoundingClientRect(),a=!0,c=0;c<o.length;c++){var l,d=Number(o[c]);i.completedGoals[d]||(Math.ceil(s.top+s.height*(d/100))<=r?(i.completedGoals[d]=!0,l=p-1,T(e,d,{post_url:n.url,feed_index:n.index,root_post_url:f.url,post_before_url:_[l]&&_[l].url})):a=!1)}i.isAllCompleted=a}}}function N(){I=I.filter(function(e){return!e.isAllCompleted})}function R(){var e,t,n;u&&u.id&&window.ym&&(e=_[p],n=_[p],u.goals[i.UNIQUE_SCROLL_POSTS_TRANSITIONS]&&-1!==u.goals[i.UNIQUE_SCROLL_POSTS_TRANSITIONS].indexOf(p)&&!E[p]&&(E[p]=!0,t=p-1,T(i.UNIQUE_SCROLL_POSTS_TRANSITIONS,p,{post_url:n.url,feed_index:n.index,root_post_url:f.url,post_before_url:_[t]&&_[t].url})),O(c.POST_BLOCK_HIT_PROGRESS,e.$element,e),O(c.POST_CONTENT_HIT_PROGRESS,e.$contentElement,e),I.forEach(function(e){var i,o,r,s,t,a;e.isAllCompleted||(i=e.goalName,o=e.postData,r=e.$element,s=e.completedGoals,t=u.goals[i],a=!0,t.forEach(function(e){var t,n;s[e]||(n=document.documentElement.clientHeight,t=r[0].getBoundingClientRect(),Math.ceil(t.top+t.height*(e/100))<=n?(s[e]=!0,n=o.index-1,T(i,e,{post_url:o.url,feed_index:o.index,root_post_url:f.url,post_before_url:_[n]&&_[n].url},0,!0)):a=!1)}),e.isAllCompleted=a)}),clearTimeout(k),k=setTimeout(N,0))}function P(){e(),R(),S()&&R()}window.infinityPostsData&&infinityPostsData.rootPost&&(t="/wp-json/infinity-posts/v1/next",o=infinityPostsData.pageTitlePostfix?" "+infinityPostsData.pageTitlePostfix:"",u=infinityPostsData.yandexMetrika,r=infinityPostsData.currentOffset||-1,s=infinityPostsData.isLast,a={excludePostsIds:infinityPostsData.otherPosts.excludePostsIds||[],beforeDate:infinityPostsData.otherPosts.beforeDate||""},i={UNIQUE_SCROLL_POSTS_TRANSITIONS:"unique_scroll_posts_transitions"},c={POST_BLOCK_HIT_PROGRESS:"post_block_hit_progress",POST_CONTENT_HIT_PROGRESS:"post_content_hit_progress",POST_BLOCK_DISPLAY_PROGRESS:"post_block_display_progress",POST_CONTENT_DISPLAY_PROGRESS:"post_content_display_progress"},l=$("#post-list"),n=$("#next-post-area"),d=$("#post-loader"),h=$("#header"),v=m=p=0,b=!(_=[]),E={},I=[],k=f=null,y=new IntervalQueues(1100),(L.prototype=Object.create(g.prototype)).constructor=L,w=-1,setTimeout(function(){!s&&history&&history.scrollRestoration&&(history.scrollRestoration="manual");var e=infinityPostsData.rootPost,t=l.find("#post-"+e.id);f=new C(e.id,t,e.url||location.pathname+location.search,e.title||document.title),window.addEventListener("scroll",P),window.addEventListener("resize",P),P()},0))}(),function(){var e,t=$("#other-projects-menu"),n=$("#other-projects-menu-button");function i(){clearTimeout(e),t.css("left",n.position().left),t.fadeIn(100)}function o(){clearTimeout(e),e=setTimeout(function(){t.fadeOut(100)},300)}n.hover(i,o),t.hover(i,o)}(),function(){function e(e){e.name&&$('.radio-tab[name="'+e.name+'"]').each(function(){this.value&&($(this).parent()[this.checked?"addClass":"removeClass"]("radio-tab-active"),$('.radio-tab-content[data-radio-tab-content-id="'+this.value+'"]')[this.checked?"addClass":"removeClass"]("radio-tab-content-show"))})}$(".radio-tab:checked").each(function(){e(this)}),$(".radio-tab").on("change",function(){e(this)})}(),function(){var o="visible",r=document.getElementsByClassName("scroll-emerging-block")||[],e=document.getElementById("header");function t(){var t=e.getBoundingClientRect().height,n=!1;for(let e=0;e<r.length;e++){const i=r[e];i.getBoundingClientRect().top-t<=0?i.classList.contains(o)||(i.classList.add(o),n=!0):i.classList.contains(o)&&(i.classList.remove(o),n=!0)}n&&Banners&&Banners.reload()}document.addEventListener("DOMContentLoaded",function(){t(),window.addEventListener("scroll",t)})}(),function(){var e=$("#header-search-button"),t=$("#search-overlay"),n=$("#header-search-block"),i=n.find(".header-search-form"),o=n.find(".header-search-input"),r=n.find(".header-search-close");function s(){o.blur(),o.val(""),t.removeClass("show"),n.animate({width:"hide"},500,"linear",function(){e.css("opacity",""),t.hide()})}e.on("click",function(){n.animate({width:"show"},500),e.css("opacity","0"),t.show({duration:0,complete:function(){t.addClass("show")}}),o.val(""),o.focus()}),r.on("click",function(){s()}),i.on("submit",function(e){console.log("submit");var t=o.val();if(t.length<2)return 0<t.length&&alert("Поисковая фраза слишком короткая!"),e.preventDefault(),!1}),o.keyup(function(e){27===e.keyCode&&s()})}(),function(){var a="show",c="shownPopup",t=1;function l(e){$.cookie(c,e,{expires:t,path:"/"})}setTimeout(function(){Banners&&Banners.reload&&Banners.reload();for(var e=document.getElementsByClassName("start-popup"),t=$.cookie(c),n=0;n<e.length;n++){var i=e[n];if(i){var o=i.dataset.popupId;if(o!==t){i.classList.add(a);for(var r=i.getElementsByClassName("start-popup-close-action"),s=0;s<r.length;s++)r[s].addEventListener("click",function(){var e,t;t=o,(e=i)&&e.classList.remove(a),l(t)});window.Banners&&Banners.addBannerEventListener("cnt-ad-banners-start_popup",BannerEvents.Click,function(e){e.rawLink&&l(o)})}}}},0)}(),$(".vacancies-block").each(function(){var e=$(this),t=e.find(".switcher"),n=e.find(".vacancies-radio-tab"),i=e.data("radio-tab-name"),o=0;function r(e){e.name===i&&t[Number($(e).data("vacancies-block-switcher-on"))?"addClass":"removeClass"]("switcher-on")}t.on("click",function(){for(var e=0;e<n.length;e++)if(n[e].checked){o=e+1;break}o>=n.length&&(o=0),$(n[o]).click()}),e.find(".radio-tab:checked").each(function(){r(this)}),e.find(".radio-tab").on("change",function(){r(this)})});